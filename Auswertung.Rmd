---
title: "Influence of personal and social benefits on the intention to donate blood in the context of age and the constructs of the Self-Determination Theory - Master Thesis"
author: "Tim Riester"
output: html_document
date: "2024-03-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


The following analyses are reported in our method study and sorted according to the order in which they appear in the corresponding report.

```{r include=FALSE, warning = FALSE, message = FALSE}
#load packages
library(psych)
library(expss)
library(plyr)
library(dplyr)
library(ggplot2)
library(ggpubr)
library(reshape2)
library(tidyr)
library(Hmisc)
library(sjPlot)
library(table1)
library(DescTools)
library(moments)
library(corrplot)
library(QuantPsyc)
library(coin)
library(corrr)
library(knitr)
library(kableExtra)
library(tidyverse)
library(apaTables)
library(sandwich)
library(carData)
library(car)
library(Rmisc)

```
#load Data
```{r}
data  <- read.csv("data_project_1013280_2024_04_17.csv", sep = ";")
```
#Overview
```{r}
describe(data)

table(data$ALTER)

table(data$ATTENTION_CHECK)

table(data$ALTER, data$ATTENTION_CHECK != 1)
```
#Of the total n = 405 participants, two people stated an age of under 18 or over 75. In addition, 7 participants did not pass the Attention Check. There were no overlaps between the participants. 

#Clean Data
```{r}
MA_data <- subset(data, ALTER >= 18 & ALTER <= 75 & ATTENTION_CHECK == 1)
```

#Data preperation


##Age Groups
```{r}
MA_data$AGE_GROUP <- NA
MA_data$AGE_GROUP <- factor(
  MA_data$AGE_GROUP,
  levels = c(1,2),
  labels = c("18-29", "30-75")
)

MA_data$AGE_GROUP[which(MA_data$ALTER >= 18 & MA_data$ALTER <=29 )] <- "18-29"
MA_data$AGE_GROUP[which(MA_data$ALTER >= 30 & MA_data$ALTER <= 75 )] <- "30-75"

summary(MA_data$ALTER)
table(MA_data$ALTER<30, MA_data$ALTER>=30)

summary(MA_data$AGE_GROUP)

agegroupwave <- c(
  "1" = "18-29",
  "2" = "30-75"
)
```

##Gender Groups
```{r}
MA_data$GENDER_GROUP <- NA
MA_data$GENDER_GROUP <- factor(
  MA_data$GENDER_GROUP,
  levels = c(1,2,3,4),
  labels = c("Weiblich","Männlich","Divers","Keine Angabe")
)

MA_data$GENDER_GROUP[which(MA_data$GESCHLECHT == 1)] <- "Weiblich"
MA_data$GENDER_GROUP[which(MA_data$GESCHLECHT == 2)] <- "Männlich"
MA_data$GENDER_GROUP[which(MA_data$GESCHLECHT == 3)] <- "Divers"
MA_data$GENDER_GROUP[which(MA_data$GESCHLECHT == 4)] <- "Keine Angabe"

summary(MA_data$GENDER_GROUP)

#data$GESCHLECHT <- factor(
#data$GESCHLECHT,
#levels = c(1,2,3,4),
#labels = c("Weiblich", "Männlich","Divers","Keine Angabe")
#)
```

##Education Groups
```{r}
MA_data$EDUCATION_GROUP <- NA
MA_data$EDUCATION_GROUP <- factor(
MA_data$EDUCATION_GROUP,
levels = c(1,2,3,4,5,6,7),
labels = c("Hauptschulabschluss","Mittlere Reife","Fachhochschulreife","Allgemeine Hochschulreife","Bachelor","Master","Andere")
)

MA_data$EDUCATION_GROUP[which(MA_data$BILDUNG == 1)] <- "Hauptschulabschluss"
MA_data$EDUCATION_GROUP[which(MA_data$BILDUNG == 2)] <- "Mittlere Reife"
MA_data$EDUCATION_GROUP[which(MA_data$BILDUNG == 3)] <- "Fachhochschulreife"
MA_data$EDUCATION_GROUP[which(MA_data$BILDUNG == 4)] <- "Allgemeine Hochschulreife"
MA_data$EDUCATION_GROUP[which(MA_data$BILDUNG == 5)] <- "Bachelor"
MA_data$EDUCATION_GROUP[which(MA_data$BILDUNG == 6)] <- "Master"
MA_data$EDUCATION_GROUP[which(MA_data$BILDUNG == 7)] <- "Andere"

summary(MA_data$EDUCATION_GROUP)
```
#Country Groups
```{r}
MA_data$COUNTRY_GROUP <- NA
MA_data$COUNTRY_GROUP <- factor(
MA_data$COUNTRY_GROUP,
levels = c(1,2,3,4),
labels = c("Deutschland","Österreich","Schweiz","Andere")
)

MA_data$COUNTRY_GROUP[which(MA_data$LAND == 1)] <- "Deutschland"
MA_data$COUNTRY_GROUP[which(MA_data$LAND == 2)] <- "Österreich"
MA_data$COUNTRY_GROUP[which(MA_data$LAND == 3)] <- "Schweiz"
MA_data$COUNTRY_GROUP[which(MA_data$LAND == 4)] <- "Andere"

summary(MA_data$COUNTRY_GROUP)
```
#Blood Donation Behavior Group
```{r}
MA_data$BDB_GROUP <- NA
MA_data$BDB_GROUP <- factor(
MA_data$BDB_GROUP,
levels = c(1,2,3),
labels = c("Ja","Nein","Keine Angabe")
)

MA_data$BDB_GROUP[which(MA_data$BLUTSPENDEVERHALTEN == 1)] <- "Ja"
MA_data$BDB_GROUP[which(MA_data$BLUTSPENDEVERHALTEN == 2)] <- "Nein"
MA_data$BDB_GROUP[which(MA_data$BLUTSPENDEVERHALTEN == 3)] <- "Keine Angabe"

table(MA_data$BDB_GROUP)

```
#Blood Donor Organisation Groups
```{r}
MA_data$BDO_GROUP <- NA
MA_data$BDO_GROUP <- factor(
MA_data$BDO_GROUP,
levels = c(1,3,4),
labels = c("Deutsches Rotes Kreuz","Weiß ich nicht","Andere")
)

MA_data$BDO_GROUP[which(MA_data$BLUTSPENDEORGANISATION == 1)] <- "Deutsches Rotes Kreuz"
MA_data$BDO_GROUP[which(MA_data$BLUTSPENDEORGANISATION == 3)] <- "Weiß ich nicht"
MA_data$BDO_GROUP[which(MA_data$BLUTSPENDEORGANISATION == 4)] <- "Andere"

table(MA_data$BDO_GROUP)
```

#Experimental Conditions
```{r}
MA_data$Condition <- factor(MA_data$c_0001, levels = c(1,2,3))
labels = c("Individual Benefit", "Social Benefit", "Kontrollgruppe")

table(MA_data$Condition)
```

# Descriptives

## Demographics

The following table shows the distribution of survey participants by demographics and experimental condition (1 = Individual Benefit, 2 = Social Benefit, 3 = Control Group)

```{r}
MA_data <- apply_labels(MA_data,
AGE_GROUP = "Age group",
GENDER_GROUP = "Gender",
EDUCATION_GROUP = "Level of education",
COUNTRY_GROUP = "Residence country")

html_code <- MA_data %>%
tab_cells(AGE_GROUP,GENDER_GROUP,EDUCATION_GROUP) %>%
tab_cols(total(label = "Sum"),Condition) %>%
tab_stat_cases(total_label = "All") %>%
tab_pivot() %>%
htmlTable(align = "c",css.cell = c("width: 400px"))

#this code must be adapted according to the personal file path

file_path <- "C:\\Users\\timri\\Desktop\\Uni Vorlesungen\\Master GeKo\\Masterarbeit\\Statistiken und Auswertung\\Auswertung"
file_name <- "Deskriptiv.html"

writeLines(html_code, file.path("C:\\Users\\timri\\Desktop\\Uni Vorlesungen\\Master GeKo\\Masterarbeit\\Statistiken und Auswertung\\Auswertung", "Deskriptiv.html"))

```

#Overall percentages for gender and education are shown such as descriptive data for age by condition.
```{r}
N <- nrow(MA_data)
ageRange_min <- min(MA_data$ALTER)
ageRange_max <- max(MA_data$ALTER)
ageMean <- mean(MA_data$ALTER)
ageSD <- sd(MA_data$ALTER)
ageMedian <- median(MA_data$ALTER)

round(table(MA_data$GESCHLECHT)/N*100,2)
round(table(MA_data$BILDUNG)/N*100,2)

describeBy(MA_data$ALTER,MA_data$Condition)
```

#Creat Index
```{r}
psych::alpha(subset(MA_data, select = c(AMOTIVATION_1,AMOTIVATION_2,AMOTIVATION_3)))

psych::alpha(subset(MA_data, select = c(EXTERNAL_REGULATION_1,EXTERNAL_REGULATION_2,EXTERNAL_REGULATION_2)))

psych::alpha(subset(MA_data, select = c(INTROJECTED_REGULATION_1,INTROJECTED_REGULATION_2,INTROJECTED_REGULATION_3)))

psych::alpha(subset(MA_data, select = c(IDENTIFIED_REGUALTION_1,IDENTIFIED_REGUALTION_2,IDENTIFIED_REGUALTION_3)))

psych::alpha(subset(MA_data, select = c(INTEGRATED_REGULATION_1,INTEGRATED_REGULATION_2,INTEGRATED_REGULATION_3)))

psych::alpha(subset(MA_data, select = c(INTRINSIC_REGUALTION_1,INTRINSIC_REGUALTION_2,INTRINSIC_REGUALTION_3)))

psych::alpha(subset(MA_data, select = c(INTENTION_1,INTENTION_2,INTENTION_3)))
```


```{r}
summary(data$c_0001)

data$Condition <- factor(data$c_0001, levels = c(1,2,3))
labels = c("Individual Benefit", "Social Benefit", "Control Group")

summary(data$Condition)
```

#Probierstation
```{r}
boxplot(data$INTENTION_1 ~ data$AGE_GROUP)
table(MA_data$INTEGRATED_REGULATION_1[MA_data$ALTER<=29])

boxplot(data$INTENTION_1 ~ MA_data$c_0001)

table(MA_data$c_0001)

mean(MA_data$INTENTION_1[MA_data$Condition==3])
```



